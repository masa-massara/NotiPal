echo "ğŸ¶ Husky: Running Biome checks before commit..."
bun run check

if [ $? -ne 0 ]; then
  echo "âŒ Biome checks failed. Please fix the issues and try committing again."
  exit 1
fi

echo "ğŸ¶ Husky: Generating API types..."
bun --cwd apps/backend run generate:api-types

# Formatã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚„ç”Ÿæˆã•ã‚ŒãŸå‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã™ã‚‹
git add .

echo "âœ… Biome checks passed! Proceeding with commit..."

# mainã¨devãƒ–ãƒ©ãƒ³ãƒã¸ã®ã‚³ãƒŸãƒƒãƒˆã‚’åˆ¶é™
echo "ğŸ¶ Husky: Checking current branch name..."

current_branch=$(git symbolic-ref --short HEAD)

PROTECTED_BRANCHES="main develop dev"

for protected_branch in $PROTECTED_BRANCHES; do
  if [ "$current_branch" = "$protected_branch" ]; then
    echo "âŒ ERROR: Direct commits to the '$current_branch' branch are not allowed!"
    echo "Please create a new feature branch (e.g., feat/your-feature-name) and make your commits there."
    exit 1 # ã‚³ãƒŸãƒƒãƒˆã‚’ä¸­æ­¢
  fi
done

echo "âœ… Branch check passed. Okay to commit to '$current_branch'."
